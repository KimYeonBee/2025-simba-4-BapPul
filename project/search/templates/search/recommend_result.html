<h2>{{ price }}원 이하 메뉴</h2>

<!-- ✅ 카테고리 필터 -->
<form method="get" action="{% url 'search:recommend_result' %}">
  <input type="hidden" name="price" value="{{ price }}">
  <input type="hidden" name="radius" value="{{ radius }}">

  <select name="category">
    <option value="">전체</option>
    {% for cat in categories %}
      <option value="{{ cat }}" {% if selected_category == cat %}selected{% endif %}>{{ cat }}</option>
    {% endfor %}
  </select>

  <button type="submit">적용</button>
</form>

<hr>

<!-- ✅ 랜덤 추천 -->
<form method="get" action="{% url 'search:random_wait' %}" style="margin-top: 10px;">
  <input type="hidden" name="price" value="{{ price }}">
  <input type="hidden" name="radius" value="{{ radius }}">
  {% if selected_category %}
    <input type="hidden" name="category" value="{{ selected_category }}">
  {% endif %}
  <button type="submit">🎲 랜덤 추천</button>
</form>

<hr>

<!-- ✅ 메뉴 리스트 -->
{% if menus %}
  <ul>
    {% for m in menus %}
      <li style="margin-bottom: 20px;">
        <a href="{% url 'menu:store_detail' store_id=m.menu.store.id menu_id=m.menu.id %}">
          <strong>{{ m.menu.name }}</strong> - {{ m.menu.price }}원<br>
          가게: {{ m.menu.store.name }}<br>
          ⭐ 평균 별점: {{ m.average_rating }} / 리뷰: {{ m.review_count }}개
        </a>

        <!-- 찜 버튼 -->
        <form method="post" action="{% url 'search:like_menu' m.menu.id %}" style="display:inline;">
          {% csrf_token %}
          <button type="submit" style="border: none; background: none; font-size: 20px; cursor: pointer;">
            {% if m.liked %}
              <span title="찜함">⭐</span>
            {% else %}
              <span title="찜 안함">☆</span>
            {% endif %}
          </button>
        </form>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>조건에 맞는 메뉴가 없습니다.</p>
{% endif %}
